<!doctype html><html lang=en><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge,chrome=1"><title>I/O Management - COMP3231 Musings</title><meta name=renderer content=webkit><meta name=viewport content="width=device-width,initial-scale=1,maximum-scale=1"><meta http-equiv=cache-control content=no-transform><meta http-equiv=cache-control content=no-siteapp><meta name=theme-color content=#f8f5ec><meta name=msapplication-navbutton-color content=#f8f5ec><meta name=apple-mobile-web-app-capable content=yes><meta name=apple-mobile-web-app-status-bar-style content=#f8f5ec><meta name=author content=z5206677><meta name=description content="Unifying the interface and communication of Input Output devices"><meta name=keywords content=Hugo,theme,even><meta name=generator content="Hugo 0.58.2 with theme even"><link rel=canonical href=../../post/io-management/><link rel=apple-touch-icon sizes=180x180 href=../../apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=../../favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=../../favicon-16x16.png><link rel=manifest href=../../manifest.json><link rel=mask-icon href=../../safari-pinned-tab.svg color=#5bbad5><link href=../../dist/even.c2a46f00.min.css rel=stylesheet><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.1.20/dist/jquery.fancybox.min.css integrity="sha256-7TyXnr2YU040zfSP+rEcz29ggW4j56/ujTPwjMzyqFY=" crossorigin=anonymous><link rel=stylesheet href=../../css/typedjs.shortcode.css><meta property=og:title content="I/O Management"><meta property=og:description content="Unifying the interface and communication of Input Output devices"><meta property=og:type content=article><meta property=og:url content=/post/io-management/><meta property=article:published_time content=2020-05-01T01:30:08+10:00><meta property=article:modified_time content=2020-05-01T01:30:08+10:00><meta itemprop=name content="I/O Management"><meta itemprop=description content="Unifying the interface and communication of Input Output devices"><meta itemprop=datePublished content=2020-05-01T01:30:08&#43;10:00><meta itemprop=dateModified content=2020-05-01T01:30:08&#43;10:00><meta itemprop=wordCount content=813><meta itemprop=keywords content><meta name=twitter:card content=summary><meta name=twitter:title content="I/O Management"><meta name=twitter:description content="Unifying the interface and communication of Input Output devices"><!--[if lte IE 9]><script src=https://cdnjs.cloudflare.com/ajax/libs/classlist/1.1.20170427/classList.min.js></script><![endif]--><!--[if lt IE 9]><script src=https://cdn.jsdelivr.net/npm/html5shiv@3.7.3/dist/html5shiv.min.js></script><script src=https://cdn.jsdelivr.net/npm/respond.js@1.4.2/dest/respond.min.js></script><![endif]--></head><body><div id=mobile-navbar class=mobile-navbar><div class=mobile-header-logo><a href=../../ class=logo>COMP3231 Musings</a></div><div class=mobile-navbar-icon><span></span><span></span><span></span></div></div><nav id=mobile-menu class="mobile-menu slideout-menu"><ul class=mobile-menu-list><a href=../../><li class=mobile-menu-item>Home</li></a><a href=https://github.com/featherbear/UNSW-COMP3231><li class=mobile-menu-item>GitHub</li></a><a href=../../categories/><li class=mobile-menu-item>Categories</li></a></ul></nav><div class=container id=mobile-panel><header id=header class=header><div class=logo-wrapper><a href=../../ class=logo>COMP3231 Musings</a></div><nav class=site-navbar><ul id=menu class=menu><li class=menu-item><a class=menu-item-link href=../../>Home</a></li><li class=menu-item><a class=menu-item-link href=https://github.com/featherbear/UNSW-COMP3231>GitHub</a></li><li class=menu-item><a class=menu-item-link href=../../categories/>Categories</a></li></ul></nav></header><main id=main class=main><div class=content-wrapper><div id=content class=content><article class=post><header class=post-header><h1 class=post-title>I/O Management</h1><div class=post-meta><span class=post-time>2020-05-01</span></div></header><div class=post-toc id=post-toc><h2 class=post-toc-title>Contents</h2><div class="post-toc-content always-active"><nav id=TableOfContents><ul><li><a href=#device-drivers>Device Drivers</a></li><li><a href=#interfacing-between-the-kernel-and-the-driver>Interfacing between the Kernel and the Driver</a></li><li><a href=#accessing-io>Accessing IO</a><ul><li><a href=#separate-io-and-memory-addresses>Separate IO and Memory Addresses</a></li><li><a href=#memory-mapped-io>Memory Mapped IO</a></li><li><a href=#bus-architecture>Bus Architecture</a></li><li><a href=#waiting-for-data>Waiting for Data</a><ul><li><a href=#waiting>Waiting</a></li><li><a href=#device-interrupts>Device Interrupts</a></li></ul></li><li><a href=#direct-memory-access>Direct Memory Access</a></li></ul></li><li><a href=#interrupt-handlers>Interrupt Handlers</a><ul><li><a href=#top-and-bottom-halves>Top and Bottom Halves</a></li></ul></li><li><a href=#buffering-and-data-rates>Buffering and Data Rates</a><ul><li><a href=#user-buffering>User Buffering</a></li></ul></li><li><a href=#single-buffer>Single Buffer</a></li><li><a href=#buffering-speed-up>Buffering Speed Up</a></li><li><a href=#double-buffer>Double Buffer</a></li><li><a href=#circular-buffer>Circular Buffer</a></li></ul></nav></div></div><div class=post-content><blockquote><p>Unifying the interface and communication of Input Output devices</p></blockquote><h1 id=device-drivers>Device Drivers</h1><blockquote><p>Software interface to hardware (so we don't need to spin a motor to access files on a hard drive)</p></blockquote><p>They translate requests from device-independent standard interfaces (<code>open</code>, <code>close</code>, <code>read</code>, <code>write</code>) to appropriate commands for the particular hardware. They also manage the initalisation and safe shutdown of hardware.</p><p>They come in two categories:</p><ul><li>Block devices - Operate with a block of data</li><li>Character / Stream devices - Operate byte by byte</li></ul><p>Drivers are <strong>thread-safe</strong> - meaning that they can be called by multiple programs, but service them in a synchronous manner</p><h1 id=interfacing-between-the-kernel-and-the-driver>Interfacing between the Kernel and the Driver</h1><p>Kernels expose a set of standard protocols and functionality (ie <code>open</code>, <code>close</code>, <code>read</code>, <code>write</code>) that drivers would extend to suit their needs.</p><p>This allows driver code to change without breaking the kernel, and kernel code to change without breaking the driver (provided they are written right, and do not violate the standard protocol).</p><h1 id=accessing-io>Accessing IO</h1><h2 id=separate-io-and-memory-addresses>Separate IO and Memory Addresses</h2><p>IO controller registers appear as IO ports, and are accessed with special IO instructions</p><h2 id=memory-mapped-io>Memory Mapped IO</h2><p>Controller registers appear as memory addresses.<br>Normal load and store instructions can be used to access the controller registers</p><h2 id=bus-architecture>Bus Architecture</h2><table><thead><tr><th align=center>Single Bus Architecture</th><th align=center>Dual Bus Architecture</th></tr></thead><tbody><tr><td align=center><img src="Screenshot from 2020-05-01 01-40-39.png" alt></td><td align=center><img src="Screenshot from 2020-05-01 01-40-44.png" alt></td></tr></tbody></table><h2 id=waiting-for-data>Waiting for Data</h2><h3 id=waiting>Waiting</h3><p>The program continuously polls the IO status register to see if the IO device is ready to transmit data</p><h3 id=device-interrupts>Device Interrupts</h3><p>Devices are connected to an Interrupt Controller (through IO bus).<br>When the device is ready, the interrupt controller sends the CPU an interrupt signal.</p><p>This method however increases the processor time, as all interrupt data is passed through the processor.</p><h2 id=direct-memory-access>Direct Memory Access</h2><p>With a DMA controller (either in the device, or external) - devices are able to access the memory without needing to involve the CPU. When a task is complete, the CPU is sent an interrupt signal, in the event that the CPU needs to do something.</p><p>Using DMA, the CPU is only involved during the start and end of the memory access; saving CPU time.<br>Less context switches and user/kernel mode switches will occur</p><h1 id=interrupt-handlers>Interrupt Handlers</h1><p>Interrupt handlers (aka Interrupt Service Routines) are program instructions that are called when their respective interrupt signal is raised. They can be executed at almost any time, and generally has no context on what process was previous running.</p><p>ISRs should run quickly and shortly; meaning that they should not require (m)any IO operation</p><h2 id=top-and-bottom-halves>Top and Bottom Halves</h2><p>Execution of the ISR is split into two halves.</p><ul><li>The Top half is the main entry point of the ISR, and controls the operation of the Bottom half</li><li>The Bottom half performs the main program work; and is not allowed to do any blocking operations</li></ul><p>This lowers the interrupt latency</p><h1 id=buffering-and-data-rates>Buffering and Data Rates</h1><p>Between different devices and controllers, they may be operating at different data rates.<br>When communicating between each other, these different data rates will mean that one device will transmit/receive data faster than the other.</p><p>Buffering aims to fix this 'clock' issue by creating a memory space where incoming data comes in until it fills.<br>When filled, all of the contents of that buffer is passed onto the device/process.</p><p>This is more efficient, as the device/process will not have to constantly keep checking for enough data.<br>And only a single system (and wakeup and block) call is needed.</p><p>Buffering does induce latency, as there is delay from waiting for data to fill, and for data to copy from the buffer into the destination location</p><h2 id=user-buffering>User Buffering</h2><p>If the buffer is paged to the disk; data could be lost, or deadlocks may exist if there is limited memory available.</p><h1 id=single-buffer>Single Buffer</h1><blockquote><p>A buffer is stored in the system memory. When filled, the buffer is copied into the user memory.</p></blockquote><ul><li>Block oriented - Input transfers</li><li>User process can process one block of data whilst the next block is read in</li><li>Swapping can occur since <strong>input is taking place in system memory</strong></li><li>OS keeps track of which system buffers are assigned to which user process</li></ul><h1 id=buffering-speed-up>Buffering Speed Up</h1><ul><li><code>T</code> - Transfer time for a block from device</li><li><code>C</code> - Computation time to process a block</li><li><code>M</code> - Time to copy kernel buffer to a user buffer</li></ul><p><code>= (T+C) / (MAX(T,C) + M)</code></p><ul><li>If the buffer fills and there is still more incoming data, data may be lost</li><li>Bounded-buffer Producer-Consumer issue</li></ul><h1 id=double-buffer>Double Buffer</h1><blockquote><p>Two system buffers are used. When one is filled, new data enters the second buffer whilst the first buffer is read out.</p></blockquote><p>Computation and memory copy can be done in transfer</p><p><code>= (T+C) / MAX(T,C+M)</code></p><p>Usually <code>M &lt;&lt; T</code> so it is favourable to employ a double buffer.</p><ul><li>May not be good enough for bursty traffic (alot at a time, then none at all)</li><li>Bounded-buffer Producer-Consumer issue</li></ul><h1 id=circular-buffer>Circular Buffer</h1><p>More than two buffers are used.</p><ul><li>Bounded-buffer Producer-Consumer issue</li></ul></div><footer class=post-footer><nav class=post-nav><a class=prev href=../../post/scheduling/><i class="iconfont icon-left"></i><span class="prev-text nav-default">Scheduling</span>
<span class="prev-text nav-mobile">Prev</span></a>
<a class=next href=../../post/final-exam/><span class="next-text nav-default">Final Exam</span>
<span class="next-text nav-mobile">Next</span>
<i class="iconfont icon-right"></i></a></nav></footer></article><script>(function(f,a,t,h,o,m){a[h]=a[h]||function(){(a[h].q=a[h].q||[]).push(arguments)};o=f.createElement('script'),m=f.getElementsByTagName('script')[0];o.async=1;o.src=t;o.id='fathom-script';m.parentNode.insertBefore(o,m)})(document,window,'//ss.featherbear.cc/tracker.js','fathom');fathom('set','siteId','NEQTU');fathom('trackPageview');</script></div></div></main><footer id=footer class=footer><div class=social-links><a href=mailto:z5206677@student.unsw.edu.au class="iconfont icon-email" title=email></a><a href=https://www.linkedin.com/in/andrewjinmengwong/ class="iconfont icon-linkedin" title=linkedin></a><a href=https://github.com/featherbear class="iconfont icon-github" title=github></a><a href=https://www.instagram.com/_andrewjwong/ class="iconfont icon-instagram" title=instagram></a><a href=../../index.xml type=application/rss+xml class="iconfont icon-rss" title=rss></a></div><div class=copyright><span class=power-by>Powered by <a class=hexo-link href=https://gohugo.io>Hugo</a></span>
<span class=division>|</span>
<span class=theme-info>Theme -
<a class=theme-link href=https://github.com/olOwOlo/hugo-theme-even>Even</a></span>
<span class=copyright-year>&copy;
2020 -
2021
<span class=heart><i class="iconfont icon-heart"></i></span><span class=author>Andrew Wong (z5206677)</span></span></div></footer><div class=back-to-top id=back-to-top><i class="iconfont icon-up"></i></div></div><script src=https://cdn.jsdelivr.net/npm/jquery@3.2.1/dist/jquery.min.js integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4=" crossorigin=anonymous></script><script src=https://cdn.jsdelivr.net/npm/slideout@1.0.1/dist/slideout.min.js integrity="sha256-t+zJ/g8/KXIJMjSVQdnibt4dlaDxc9zXr/9oNPeWqdg=" crossorigin=anonymous></script><script src=https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.1.20/dist/jquery.fancybox.min.js integrity="sha256-XVLffZaxoWfGUEbdzuLi7pwaUJv1cecsQJQqGLe7axY=" crossorigin=anonymous></script><script type=text/javascript src=../../dist/even.26188efa.min.js></script><script type=application/javascript>var doNotTrack=false;if(!doNotTrack){window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;ga('create','UA-107434487-2','auto');ga('send','pageview');}</script><script async src=https://www.google-analytics.com/analytics.js></script><script src=../../js/typed.js@2.0.9></script><script src=../../js/typedjs.shortcode.js></script></body></html>