<!doctype html><html lang=en><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge,chrome=1"><title>Virtual Memory Management - COMP3231 Musings</title><meta name=renderer content=webkit><meta name=viewport content="width=device-width,initial-scale=1,maximum-scale=1"><meta http-equiv=cache-control content=no-transform><meta http-equiv=cache-control content=no-siteapp><meta name=theme-color content=#f8f5ec><meta name=msapplication-navbutton-color content=#f8f5ec><meta name=apple-mobile-web-app-capable content=yes><meta name=apple-mobile-web-app-status-bar-style content=#f8f5ec><meta name=author content=z5206677><meta name=description content="Segmentation / On-Demand Paging Only crucial parts of a program (i."><meta name=keywords content=Hugo,theme,even><meta name=generator content="Hugo 0.58.2 with theme even"><link rel=canonical href=../../post/virtual-memory-management/><link rel=apple-touch-icon sizes=180x180 href=../../apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=../../favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=../../favicon-16x16.png><link rel=manifest href=../../manifest.json><link rel=mask-icon href=../../safari-pinned-tab.svg color=#5bbad5><link href=../../dist/even.c2a46f00.min.css rel=stylesheet><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.1.20/dist/jquery.fancybox.min.css integrity="sha256-7TyXnr2YU040zfSP+rEcz29ggW4j56/ujTPwjMzyqFY=" crossorigin=anonymous><link rel=stylesheet href=../../css/typedjs.shortcode.css><meta property=og:title content="Virtual Memory Management"><meta property=og:description content="Segmentation / On-Demand Paging Only crucial parts of a program (i."><meta property=og:type content=article><meta property=og:url content=/post/virtual-memory-management/><meta property=article:published_time content=2020-04-30T21:01:15+10:00><meta property=article:modified_time content=2020-04-30T21:01:15+10:00><meta itemprop=name content="Virtual Memory Management"><meta itemprop=description content="Segmentation / On-Demand Paging Only crucial parts of a program (i."><meta itemprop=datePublished content=2020-04-30T21:01:15&#43;10:00><meta itemprop=dateModified content=2020-04-30T21:01:15&#43;10:00><meta itemprop=wordCount content=655><meta itemprop=keywords content><meta name=twitter:card content=summary><meta name=twitter:title content="Virtual Memory Management"><meta name=twitter:description content="Segmentation / On-Demand Paging Only crucial parts of a program (i."><!--[if lte IE 9]><script src=https://cdnjs.cloudflare.com/ajax/libs/classlist/1.1.20170427/classList.min.js></script><![endif]--><!--[if lt IE 9]><script src=https://cdn.jsdelivr.net/npm/html5shiv@3.7.3/dist/html5shiv.min.js></script><script src=https://cdn.jsdelivr.net/npm/respond.js@1.4.2/dest/respond.min.js></script><![endif]--></head><body><div id=mobile-navbar class=mobile-navbar><div class=mobile-header-logo><a href=../../ class=logo>COMP3231 Musings</a></div><div class=mobile-navbar-icon><span></span><span></span><span></span></div></div><nav id=mobile-menu class="mobile-menu slideout-menu"><ul class=mobile-menu-list><a href=../../><li class=mobile-menu-item>Home</li></a><a href=https://github.com/featherbear/UNSW-COMP3231><li class=mobile-menu-item>GitHub</li></a><a href=../../categories/><li class=mobile-menu-item>Categories</li></a></ul></nav><div class=container id=mobile-panel><header id=header class=header><div class=logo-wrapper><a href=../../ class=logo>COMP3231 Musings</a></div><nav class=site-navbar><ul id=menu class=menu><li class=menu-item><a class=menu-item-link href=../../>Home</a></li><li class=menu-item><a class=menu-item-link href=https://github.com/featherbear/UNSW-COMP3231>GitHub</a></li><li class=menu-item><a class=menu-item-link href=../../categories/>Categories</a></li></ul></nav></header><main id=main class=main><div class=content-wrapper><div id=content class=content><article class=post><header class=post-header><h1 class=post-title>Virtual Memory Management</h1><div class=post-meta><span class=post-time>2020-04-30</span></div></header><div class=post-toc id=post-toc><h2 class=post-toc-title>Contents</h2><div class="post-toc-content always-active"><nav id=TableOfContents><ul><li><a href=#segmentation-on-demand-paging>Segmentation / On-Demand Paging</a></li><li><a href=#working-set>Working Set</a><ul><li><a href=#thrashing>Thrashing</a><ul><li><a href=#recovery>Recovery</a></li></ul></li></ul></li><li><a href=#factors-affecting-vm-system-performance>Factors affecting VM system performance</a><ul><li><a href=#page-size>Page Size</a><ul><li><a href=#a-larger-page-size>A larger page size...</a></li><li><a href=#flexible-page-sizes>Flexible Page Sizes</a></li></ul></li><li><a href=#fetch-policy>Fetch Policy</a></li><li><a href=#replacement-policy>Replacement Policy</a><ul><li><a href=#types-of-algorithms-in-order-of-best-to-worst>Types of Algorithms (in order of best to worst)</a></li></ul></li><li><a href=#resident-set-size>Resident Set Size</a><ul><li><a href=#fixed>Fixed</a></li></ul></li><li><a href=#variable-allocation>Variable Allocation</a><ul><li><a href=#on-demand-allocation>On-Demand Allocation</a></li></ul></li><li><a href=#cleaning-policy>Cleaning Policy</a></li></ul></li></ul></nav></div></div><div class=post-content><h1 id=segmentation-on-demand-paging>Segmentation / On-Demand Paging</h1><p>Only crucial parts of a program (i.e the program's code) need to reside in the memory during execution.<br>Other resources that are rarely used the process can be transferred off the memory and onto a secondary storage - to free up the memory.</p><p>If these non-resident pages are requested, the process is blocked (waiting for the IO request) and another process is allowed to run. When the IO request is complete (loading the page back into memory) the original process is again allowed to execute.</p><p>If a page to be transferred off from the RAM is clean (aka the dirty bit is <em>not</em> set) - it can simply be discarded; as there will be no difference to retrieving the location again.</p><h1 id=working-set>Working Set</h1><p>The pages required by an application over a period of time is call its <strong>memory working set</strong>.<br>It can be used as an approximation for the measure of a program's locality.</p><p>This working set is roughly the amount of pages that a system should keep in its memory at minimum.</p><h2 id=thrashing>Thrashing</h2><p><img src="Screenshot from 2020-04-30 20-58-26.png" alt></p><p>Thrashing is the occurrence where processes are unable to run due to a lack of available resources</p><ul><li>CPU utilisation often as more processes are run.</li><li>The more processes there are running, the less memory there is available for each process.</li><li>If processes are not able to get their minimum working set size - there will be lots of page faults<ul><li>Guaranteed to be at least one page fault for every cycle of the program - BAD!</li></ul></li><li>Processes will have insufficient resources, and will be unable to run</li></ul><p>CPU utilisation will therefore go down, and the system becomes IO limited</p><h3 id=recovery>Recovery</h3><ul><li>Suspend some processes</li><li>Move pages of suspended process to secondary storage (<a href=#segmentation>segmentation</a>)</li></ul><p>This way there will be more available memory for each process, and hopefully processes will be able to resume</p><h1 id=factors-affecting-vm-system-performance>Factors affecting VM system performance</h1><ul><li><a href=../virtual-memory#page-tables>Page Table structure</a></li><li><a href=#page-size>Page Size</a></li><li><a href=#fetch-policy>Fetch Policy</a></li><li><a href=#replacement-policy>Replacement Policy</a></li><li><a href=#resident-set-size>Resident Set Size</a></li><li><a href=#cleaning-policy>Page Cleaning Policy</a></li></ul><h2 id=page-size>Page Size</h2><h3 id=a-larger-page-size>A larger page size...</h3><ul><li>Decreased the number of pages (smaller page table)</li><li>Increases TLB coverage (less TLB misses)</li><li>Higher swapping IO throughput (less IO delay)</li><li>(Increases internal fragmentation - Less flexible for processes that require little resource)</li><li>(Increases page fault latency - More data to read from disk)</li></ul><h3 id=flexible-page-sizes>Flexible Page Sizes</h3><p>Multiple page sizes would allow the system to be more efficient, as memory can be distributed more equitably.</p><p>i.e. Larger page sizes for code, smaller page sizes for stacks</p><h2 id=fetch-policy>Fetch Policy</h2><blockquote><p>When should a page be loaded?</p></blockquote><ul><li>On-Demand<ul><li>Fetch when requested</li><li>A lot of page faults as the program starts</li></ul></li><li>Pre-paging<ul><li>Read more / related pages</li><li>Fetch when idle</li><li>Hard to get right in practice</li></ul></li></ul><h2 id=replacement-policy>Replacement Policy</h2><blockquote><p>Which occupied page to remove for the new page</p></blockquote><p>Optimally, discard the page that is least likely to be used soon.</p><p>Some frames may be locked, due to them being essential to system operation. For example, kernel code, kernel data, IO buffers, amd/or critical user pages.</p><h3 id=types-of-algorithms-in-order-of-best-to-worst>Types of Algorithms (in order of best to worst)</h3><ul><li><s>Hypothetical optimal - Discard the page that won't be used for the longest time (Impossible)</s></li><li>Least Recently Used - LRU - Discard the page with the smallest counter (Counter incremented on every reference)</li><li>Clock Page Replacement - Check for pages that have been used within a given time, discard the first unused one</li><li>First In, First Out - FIFO - Discard earliest page</li></ul><h2 id=resident-set-size>Resident Set Size</h2><blockquote><p>How many frames should each process have?</p></blockquote><h3 id=fixed>Fixed</h3><ul><li>Assign all frames at run-time</li><li>Some frames may not be utilised (wasted)</li></ul><h2 id=variable-allocation>Variable Allocation</h2><ul><li>Check application type and requirements as to how many frames to allocate</li></ul><h3 id=on-demand-allocation>On-Demand Allocation</h3><ul><li>Allocate a new frame when requested</li></ul><h2 id=cleaning-policy>Cleaning Policy</h2><ul><li>Observation - Read-only / Clean pages are cheaper and easier to replace than dirty pages</li><li>On Demand - Clean when selected - Takes time for selection and for actual cleaning to happen</li><li>Pre-cleaning - Pages are written out in batches (pagedaemon)</li></ul></div><footer class=post-footer><nav class=post-nav><a class=prev href=../../post/translation-lookaside-buffer/><i class="iconfont icon-left"></i><span class="prev-text nav-default">TLB - Translation Lookaside Buffer</span>
<span class="prev-text nav-mobile">Prev</span></a>
<a class=next href=../../post/multiprocessor-systems/><span class="next-text nav-default">Multiprocessor Systems</span>
<span class="next-text nav-mobile">Next</span>
<i class="iconfont icon-right"></i></a></nav></footer></article><script>(function(f,a,t,h,o,m){a[h]=a[h]||function(){(a[h].q=a[h].q||[]).push(arguments)};o=f.createElement('script'),m=f.getElementsByTagName('script')[0];o.async=1;o.src=t;o.id='fathom-script';m.parentNode.insertBefore(o,m)})(document,window,'//ss.featherbear.cc/tracker.js','fathom');fathom('set','siteId','NEQTU');fathom('trackPageview');</script></div></div></main><footer id=footer class=footer><div class=social-links><a href=mailto:z5206677@student.unsw.edu.au class="iconfont icon-email" title=email></a><a href=https://www.linkedin.com/in/andrewjinmengwong/ class="iconfont icon-linkedin" title=linkedin></a><a href=https://github.com/featherbear class="iconfont icon-github" title=github></a><a href=https://www.instagram.com/_andrewjwong/ class="iconfont icon-instagram" title=instagram></a><a href=../../index.xml type=application/rss+xml class="iconfont icon-rss" title=rss></a></div><div class=copyright><span class=power-by>Powered by <a class=hexo-link href=https://gohugo.io>Hugo</a></span>
<span class=division>|</span>
<span class=theme-info>Theme -
<a class=theme-link href=https://github.com/olOwOlo/hugo-theme-even>Even</a></span>
<span class=copyright-year>&copy;
2020 -
2021
<span class=heart><i class="iconfont icon-heart"></i></span><span class=author>Andrew Wong (z5206677)</span></span></div></footer><div class=back-to-top id=back-to-top><i class="iconfont icon-up"></i></div></div><script src=https://cdn.jsdelivr.net/npm/jquery@3.2.1/dist/jquery.min.js integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4=" crossorigin=anonymous></script><script src=https://cdn.jsdelivr.net/npm/slideout@1.0.1/dist/slideout.min.js integrity="sha256-t+zJ/g8/KXIJMjSVQdnibt4dlaDxc9zXr/9oNPeWqdg=" crossorigin=anonymous></script><script src=https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.1.20/dist/jquery.fancybox.min.js integrity="sha256-XVLffZaxoWfGUEbdzuLi7pwaUJv1cecsQJQqGLe7axY=" crossorigin=anonymous></script><script type=text/javascript src=../../dist/even.26188efa.min.js></script><script type=application/javascript>var doNotTrack=false;if(!doNotTrack){window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;ga('create','UA-107434487-2','auto');ga('send','pageview');}</script><script async src=https://www.google-analytics.com/analytics.js></script><script src=../../js/typed.js@2.0.9></script><script src=../../js/typedjs.shortcode.js></script></body></html>